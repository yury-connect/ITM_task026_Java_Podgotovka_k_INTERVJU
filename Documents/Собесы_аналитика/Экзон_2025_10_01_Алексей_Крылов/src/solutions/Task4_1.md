# Задача № 4:

---
**Дана схема БД**

![Схема|500](../_Attachments_Task4/shema_BD.png)

У клиента может не быть лицевых счетов. 
По лицевому счёту может не быть транзакций.

Необходимо написать SQL-запрос, возвращающий имя клиента, 
описание его лицевого счёта и среднюю сумму транзакции по этому счёту.

---
# РЕШЕНИЕ:
### ## Альтернативный вариант *(если нужно включить клиентов без счетов)*:
```sql
SELECT 
    c.Name AS CustomerName,
    a.Description AS AccountDescription,
    AVG(ft.TransactionAmount) AS AverageTransactionAmount
FROM Customer c
LEFT JOIN Account a ON c.id = a.Customer_id
LEFT JOIN Fin_Transaction ft ON a.id = ft.Account_Id
GROUP BY c.id, c.Name, a.id, a.Description;
```
## Пример результата:

| CustomerName | AccountDescription | AverageTransactionAmount |
|:-------------|:-------------------|:-------------------------|
| Иванов       | Основной счет      | 1500.50                  |
| Петров       | Депозит            | 2500.00                  |
| Сидоров      | Кредитный счет     | NULL                     |
| Кузнецов     | Инвестиционный     | 1800.75                  |

## Важные замечания:

1. **Для счетов без транзакций** в столбце `AverageTransactionAmount` будет `NULL`
    
2. **Каждый счет клиента** отображается отдельной строкой
    
3. **Если у клиента несколько счетов** - будет несколько строк с его именем
    
4. **Группировка по ID** предотвращает дублирование при одинаковых именах клиентов или описаний счетов

Этот запрос точно соответствует требованиям задачи и возвращает именно те данные, которые указаны в условии.

---

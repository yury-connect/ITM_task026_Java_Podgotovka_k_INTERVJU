# **`GC`** ‚Äî —á—Ç–æ —ç—Ç–æ –∏ –∑–∞—á–µ–º –Ω—É–∂–µ–Ω (*–ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º*) ‚úÖ

**Garbage Collector (GC)** ‚Äî —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç –≤ JVM, –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å –æ—Ç –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã.  
–ó–∞–¥–∞—á–∞ GC ‚Äî –Ω–µ –¥–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —É–ø–∞—Å—Ç—å –∏–∑-–∑–∞ –Ω–µ—Ö–≤–∞—Ç–∫–∏ –ø–∞–º—è—Ç–∏ –∏ –ø—Ä–∏ —ç—Ç–æ–º –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—É–∑—ã (–∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ¬´–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è¬ª –Ω–∞ —Å–±–æ—Ä–∫—É).

---
# –ö–æ—Ä–æ—Ç–∫–æ: –∑–∞—á–µ–º –Ω—É–∂–µ–Ω `GC`

- –£–±–∏—Ä–∞–µ—Ç _–º—ë—Ä—Ç–≤—ã–µ_ –æ–±—ä–µ–∫—Ç—ã (*–∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª—å—à–µ –Ω–µ –¥–æ—Å—Ç–∏–∂–∏–º—ã*) ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –Ω–µ –Ω–∞–¥–æ –≤—Ä—É—á–Ω—É—é `free`.    
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ (*–µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç –ø–æ –ª–æ–≥–∏–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è*).    
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –∫—É—á–µ–π (heap): –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, —É–ø–ª–æ—Ç–Ω–µ–Ω–∏–µ, —Ä–æ—Ç–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤.    

> –ú–Ω–µ–º–æ–Ω–∏–∫–∞: **GC = —É–±–æ—Ä—â–∏–∫¬ª (—É–±–∏—Ä–∞–µ—Ç –Ω–µ–Ω—É–∂–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã), –Ω–µ –¥–≤–æ—Ä–Ω–∏–∫ ‚Äî –æ–Ω —Å—Ç–∞—Ä–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–∏—Ö–æ.** üßπ

---
# –ö–∞–∫ `GC` –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ –æ–±—ä–µ–∫—Ç ¬´*–Ω–µ –Ω—É–∂–µ–Ω*¬ª ‚Äî –¥–æ—Å—Ç—É–ø –∫ –æ–±—ä–µ–∫—Ç–∞–º (*reachability*)

1. **GC Roots** ‚Äî –∫–æ—Ä–Ω–∏, –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ–±—Ö–æ–¥:    
    - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Å—Ç–µ–∫–µ –ø–æ—Ç–æ–∫–æ–≤ (–ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ),        
    - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è (static),        
    - JNI-—Ö–µ–Ω–¥–ª—ã, —Å–∏—Å—Ç–µ–º–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã.
    
2. **Reachable (–¥–æ—Å—Ç–∏–∂–∏–º—ã–µ)** ‚Äî –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏, –ø—Ä–æ–π–¥—è —Å—Å—ã–ª–∫–∏ –æ—Ç –∫–∞–∫–æ–≥–æ-—Ç–æ GC Root, –æ–Ω –∂–∏–≤ –∏ –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è.
    
3. **Unreachable (–Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º—ã–µ)** ‚Äî –µ—Å–ª–∏ –æ—Ç –∫–æ—Ä–Ω–µ–π –¥–æ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ—Ç –ø—É—Ç–∏ ‚Äî –æ–±—ä–µ–∫—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è –º—ë—Ä—Ç–≤ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ–±—Ä–∞–Ω.    

> –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ ‚Äî —Ç–∏–ø—ã —Å—Å—ã–ª–æ–∫ (–≤–∞–∂–Ω–æ –¥–ª—è –∫—ç—à–µ–π –∏ —Å–ª–∞–±—ã—Ö —Å—Å—ã–ª–æ–∫):
> - **Strong** ‚Äî –æ–±—ã—á–Ω–∞—è —Å—Å—ã–ª–∫–∞ (–æ–±—ä–µ–∫—Ç –∂–∏–≤ —Ç–æ—á–Ω–æ).    
> - **Soft** ‚Äî GC —É–¥–∞–ª–∏—Ç –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏ (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –∫—ç—à–∞).    
> - **Weak** ‚Äî —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π GC, –µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ weak-—Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–µ–≥–æ.    
> - **Phantom** ‚Äî –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏/–æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ (*–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–¥–∫–æ*).    

---
# **–ü—Ä–æ—Å—Ç–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞** –ø—Ä–æ—Ü–µ—Å—Å–∞ (*–≤ —Å–ª–æ–≤–∞—Ö*)

- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç—ã ‚Üí –æ–Ω–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ `Eden` (*young-–ø–æ–∫–æ–ª–µ–Ω–∏–µ*).
    
- –ö–æ–≥–¥–∞ `Eden` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è **`Minor GC`**: –∂–∏–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ `Survivor` –∏–ª–∏ –ø–æ–≤—ã—à–∞—é—Ç—Å—è (`promote`) –≤ —Å—Ç–∞—Ä—à–µ–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ.
    
- –ö–æ–≥–¥–∞ —Å—Ç–∞—Ä—à–µ–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ –Ω–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è ‚Üí **`Major`/`Full GC`**: –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã, –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç—Å—è –∏ —á–∞—Å—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É–ø–ª–æ—Ç–Ω–µ–Ω–∏–µ (*compaction*). –≠—Ç–æ <u>–¥–æ—Ä–æ–∂–µ</u> –∏ –≤—ã–∑—ã–≤–∞–µ—Ç <u>–±–æ–ª—å—à–∏–µ –ø–∞—É–∑—ã</u>.    

---
# –ö–∞–∫–∏–µ –µ—Å—Ç—å **—Ç–∏–ø—ã —Å–±–æ—Ä—â–∏–∫–æ–≤** (*–≤ –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª–æ–≤–∞—Ö*)

- **Serial GC** ‚Äî –æ–¥–∏–Ω –ø–æ—Ç–æ–∫, –ø—Ä–æ—Å—Ç, –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–≤–µ—Ä—Ö–µ–¥, –Ω–æ –±–æ–ª—å—à–∏–µ –ø–∞—É–∑—ã)
    
- **Parallel (Throughput) GC** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤, —Ö–æ—Ä–æ—à –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á/throughput, –Ω–æ –ø–∞—É–∑—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–º–µ—Ç–Ω—ã.
    
- **G1 (Garbage-First)** ‚Äî –¥–µ–ª–∏—Ç heap –Ω–∞ —Ä–µ–≥–∏–æ–Ω—ã, —Å—Ç–∞—Ä–∞–µ—Ç—Å—è –¥–µ—Ä–∂–∞—Ç—å –ø–∞—É–∑—ã –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º–∏; —á–∞—Å—Ç–æ default –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö JVM. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –±–æ–ª—å—à–∏–º heap.
    
- **ZGC** ‚Äî ¬´–ø–æ—á—Ç–∏ –Ω—É–ª–µ–≤—ã–µ¬ª –ø–∞—É–∑—ã (concurrent), —Ö–æ—Ä–æ—à –¥–ª—è –±–æ–ª—å—à–∏—Ö heap –∏ –Ω–∏–∑–∫–æ–π –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.
    
- **Shenandoah** ‚Äî –∫–∞–∫ ZGC, —Ç–æ–∂–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—É–∑—ã, –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–π compaction.
    
- **CMS (old)** ‚Äî concurrent mark-sweep, —É—Å—Ç–∞—Ä–µ–ª ‚Äî –±—ã–ª –ø–æ–ø—ã—Ç–∫–æ–π —É–º–µ–Ω—å—à–∏—Ç—å –ø–∞—É–∑—ã, –Ω–æ —Å–ª–æ–∂–µ–Ω –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.    

>–ö–æ–≥–¥–∞ –≥–æ–≤–æ—Ä–∏—Ç—å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏:
>- –î–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö/–Ω–∏–∂–Ω–∏—Ö –∑–∞–¥–µ—Ä–∂–µ–∫ ‚Äî **G1** –∏–ª–∏ **ZGC**; –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á ‚Äî **Parallel**.

---
# –ß—Ç–æ –∑–Ω–∞—á–∏—Ç ¬´**–ø–∞—É–∑–∞**¬ª –∏ –ø–æ—á–µ–º—É –µ—ë –±–æ—è—Ç—Å—è

- **Stop-The-World (STW)** ‚Äî —Ñ–∞–∑—ã `GC`, –∫–æ–≥–¥–∞ –≤—Å–µ –ø–æ—Ç–æ–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è. –ß–µ–º –¥–æ–ª—å—à–µ STW ‚Äî —Ç–µ–º –≤—ã—à–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö —Å–µ—Ä–≤–∏—Å–∞.
    
- –ö–æ–ª–ª–µ–∫—Ç–æ—Ä—ã —Ç–∏–ø–∞ `ZGC`/`Shenandoah` –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç *STW*, –¥–µ–ª–∞—è –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã <u>–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ</u>.    

---
# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å

- **Heap –æ–¥–∏–Ω** –Ω–∞ JVM; —Å—Ç–µ–∫–æ–≤ –º–Ω–æ–≥–æ ‚Äî –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –ø–æ—Ç–æ–∫.
    
- –ß–∞—Å—Ç–∞—è –ø—Ä–∏—á–∏–Ω–∞ OOM ‚Äî —É—Ç–µ—á–∫–∏: –Ω–µ–æ—á–∏—â–∞–µ–º—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏, ThreadLocal –±–µ–∑ `remove()`, —Ä–µ—Å—É—Ä—Å—ã –±–µ–∑ close.
    
- –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∞–ª–ª–æ–∫–∞—Ü–∏–π JVM –¥–∞—ë—Ç –∫–∞–∂–¥–æ–º—É –ø–æ—Ç–æ–∫—É TLAB (–º–∞–ª–µ–Ω—å–∫–∞—è ¬´–ø–æ–ª–æ—Å–∞¬ª –≤ Eden) ‚Äî –±—ã—Å—Ç—Ä—ã–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è –±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.
    
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç GC, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –º–µ—Ç—Ä–∏–∫–∏ (JFR, GC-–ª–æ–≥–∏), –∞ –Ω–µ ¬´—É–≥–∞–¥–∞—Ç—å¬ª.    

---

# –ö–∞–∫ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ —Å–ø—Ä–æ—Å—è—Ç –±—ã—Å—Ç—Ä–æ (–∫–æ—Ä–æ—Ç–∫–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞)

> ¬´GC –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º—ã–µ –æ–±—ä–µ–∫—Ç—ã: —Å—Ç–∞—Ä—Ç—É–µ—Ç –æ—Ç GC-roots –∏ –ø–æ–º–µ—á–∞–µ—Ç/—Å–æ–±–∏—Ä–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã. –ú–æ–ª–æ–¥–æ–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —á–∞—Å—Ç–æ (Minor GC), —Å—Ç–∞—Ä–æ–µ ‚Äî —Ä–µ–∂–µ (Major/Full). –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–±–æ—Ä—â–∏–∫–∏ ‚Äî G1/ZGC ‚Äî –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç –ø–∞—É–∑—ã; –≤—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π: throughput vs latency.¬ª

---

# –ü–æ–ª–µ–∑–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç (–¥–ª—è –ø–∞–º—è—Ç–∏) üß†

- GC –æ—á–∏—â–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º—ã–µ –æ–±—ä–µ–∫—Ç—ã (–æ—Ç GC-roots).
    
- –ï—Å—Ç—å –ø–æ–∫–æ–ª–µ–Ω–∏—è: Young (Eden + Survivor) ‚Üí Old.
    
- Minor GC = –±—ã—Å—Ç—Ä–æ, —á–∞—Å—Ç–æ; Full GC = –º–µ–¥–ª–µ–Ω–Ω–æ, —Ä–µ–¥–∫–æ.
    
- –ö–æ–ª–ª–µ–∫—Ç–æ—Ä—ã: Serial, Parallel, G1, ZGC, Shenandoah.
    
- –°—Å—ã–ª–∫–∏: strong/soft/weak/phantom.
    
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏: JFR, GC-–ª–æ–≥–∏, jstat, jmap.
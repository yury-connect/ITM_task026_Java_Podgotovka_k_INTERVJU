–î–∞–º ¬´—É—Ä–æ–≤–µ–Ω—å **–º–∏–¥–¥–ª–∞** —Å **DevOps-–Ω–∞—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ—Å—Ç—å—é**¬ª: —á—ë—Ç–∫–æ, –ø–æ —à–∞–≥–∞–º, –±–µ–∑ –≤–æ–¥—ã.

---
# `Kubernetes` ‚Äî –º–æ—è –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å
**–£—Ä–æ–≤–µ–Ω—å:** —É–≤–µ—Ä–µ–Ω–Ω—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —É–º–µ—é –¥–µ–ø–ª–æ–∏—Ç—å —á–µ—Ä–µ–∑ [Helm](../../../TECHNOLOGIES/–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è/Kubernetes/Helm/Helm_info.md), —á–∏—Ç–∞—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã (Deployment/Service/Ingress/ConfigMap/Secret), –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å probes/—Ä–µ—Å—É—Ä—Å—ã/HPA, –¥–µ–ª–∞—Ç—å rollback/rollout status, —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏/–∏–≤–µ–Ω—Ç—ã. –†–∞–±–æ—Ç–∞—é —á–µ—Ä–µ–∑ Jenkins ‚Üí Helm ‚Üí k8s.

---
## 1) –ß–µ–º –¥–µ–ø–ª–æ–∏–ª–æ—Å—å –≤ `Kubernetes`?

- üß∞ **[Helm](../../../TECHNOLOGIES/–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è/Kubernetes/Helm/Helm_info.md)**: —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π **Helm-chart** —Å–µ—Ä–≤–∏—Å–∞ (*–±–∞–∑–∞ –æ—Ç DevOps, —è –¥–æ–ø–∏–ª–∏–≤–∞–ª values, probes, —Ä–µ—Å—É—Ä—Å—ã*).
    
- üß© –í —á–∞—Ä—Ç–µ: `Deployment`, `Service (ClusterIP)`, `Ingress (nginx)`, `ConfigMap`, `Secret`, `HPA`, `ServiceAccount` + **Helm-hooks** –¥–ª—è Liquibase job (pre-upgrade).
    
- üì¶ Registry: Harbor/Artifactory (*–æ–±—Ä–∞–∑ –∏–∑ CI*).    

---
## 2) –ú–µ—Ö–∞–Ω–∏–∑–º: –µ—Å—Ç—å `Docker`-–æ–±—Ä–∞–∑ ‚Üí<br>‚Üí –∫–∞–∫ –æ–Ω –ø–æ–ø–∞–¥–∞–µ—Ç –≤ `k8s`

1. –û–±—Ä–∞–∑ –∑–∞–ø—É—à–µ–Ω –≤ `registry` —Å —Ç–µ–≥–æ–º `app:gitSha` (–∏–ª–∏ `buildNumber`).
    
2. **Jenkins** –≤—ã–∑—ã–≤–∞–µ—Ç `helm upgrade --install` —Å `values-test.yaml`, –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—è `image.tag`.
    
3. `Deployment` –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–π `ReplicaSet`, —Å—Ç—Ä–∞—Ç–µ–≥–∏—è **RollingUpdate** (`maxSurge=1`, `maxUnavailable=0`).
    
4. `kubelet` —Ç—è–Ω–µ—Ç –æ–±—Ä–∞–∑ (`imagePullSecret`), –ø–æ–¥—ã —Å—Ç–∞—Ä—Ç—É—é—Ç.
    
5. –°—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç **liveness/readiness** probes ‚Üí —Ç–æ–ª—å–∫–æ **Ready** –ø–æ–¥—ã –ø–æ–ø–∞–¥–∞—é—Ç –∑–∞ **Service**.
    
6. **Service** –¥–∞—ë—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π endpoint; **Ingress** –ø—É–±–ª–∏–∫—É–µ—Ç URL –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –¥–æ–º–µ–Ω–µ.
    
7. Helm-hook –∑–∞–ø—É—Å–∫–∞–µ—Ç **Liquibase Job** (–µ—Å–ª–∏ –µ—Å—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏), –∂–¥—ë–º —É—Å–ø–µ—Ö–∞ ‚Üí –∑–∞–≤–µ—Ä—à–∞–µ–º —Ä–µ–ª–∏–∑.    

---
## 3) –ü–æ—Å–ª–µ merge –≤ `test`: —á—Ç–æ —è –¥–µ–ª–∞—é, —á—Ç–æ–±—ã —Ä–µ–ª–∏–∑ –æ–∫–∞–∑–∞–ª—Å—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å—Ç–µ–Ω–¥–µ

- üîÅ **–ù–∏—á–µ–≥–æ –≤—Ä—É—á–Ω—É—é –Ω–µ –ø—Ä–æ—à—É**: —Ä–∞—Å–∫–∞—Ç–∫–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è**. Merge –≤ `test` —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç Jenkins-pipeline **CD** –Ω–∞ `test` namespace.
    
- ‚úÖ –Ø **–º–æ–Ω–∏—Ç–æ—Ä—é** –ø–∞–π–ø–ª–∞–π–Ω, –ø—Ä–æ–≤–µ—Ä—è—é `helm release` –∏ readiness, —Å–º–æ—Ç—Ä—é **smoke-—Ç–µ—Å—Ç—ã** –∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ –≤ Slack/Teams.
    
- üß™ –î–∞–ª–µ–µ —Å–∞–º **–¥–µ—Ä–≥–∞—é API** –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º URL (Swagger, Postman), –ø—Ä–æ–≤–µ—Ä—è—é –≥—Ä–∞—Ñ–∏–∫–∏/–ª–æ–≥–∏.    

---
## 4) –ü–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ ¬´–Ω–∞–ø–∏—Å–∞–ª –∫–æ–¥ ‚Üí —Å—Ç–∞–ª –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ —Å—Ç–µ–Ω–¥–µ¬ª (–≥–ª—É–±–æ–∫–æ)

1. **Commit/PR ‚Üí review ‚Üí merge –≤ `test`**.
    
2. **Jenkins CI**:    
    - `mvn clean verify` (—é–Ω–∏—Ç/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã).        
    - –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞ `app:gitSha`.        
    - (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) **Trivy**/scan –æ–±—Ä–∞–∑–∞.        
    - Push –≤ **registry**.
    
3. **Jenkins CD** (—Ç–æ—Ç –∂–µ pipeline –ª–∏–±–æ downstream job):    
    - `helm upgrade --install app charts/app -f values-test.yaml --set image.tag=gitSha`        
    - **Helm pre-hook**: `Job` —Å **Liquibase** (–º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã).        
    - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ **Deployment** ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π **ReplicaSet**.        
    - **RollingUpdate**: —Å—Ç–∞—Ä—ã–µ –ø–æ–¥—ã –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–æ–≤—ã–º–∏.        
    - **Probes**: readiness/liveness (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/actuator/health`).        
    - **Service** —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º; –∫–∞–∫ —Ç–æ–ª—å–∫–æ –ø–æ–¥—ã `Ready`, —Ç—Ä–∞—Ñ–∏–∫ –∏–¥—ë—Ç –Ω–∞ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é.        
    - **Ingress** –¥–∞—ë—Ç –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø: `https://test.company.local/my-service`.
    
4. **Smoke-—Ç–µ—Å—Ç—ã** (Postman/Newman/REST-assured) –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∏–∑ Jenkins.
    
5. **–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å**:    
    - –õ–æ–≥–∏ –≤ **ELK** (Kibana).        
    - –ú–µ—Ç—Ä–∏–∫–∏ –≤ **Prometheus/Grafana** (RPS, latency, 5xx, JVM).        
    - –ê–ª–µ—Ä—Ç—ã/–Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ Slack/Teams.
    
6. **–ö–æ–Ω—Ñ–∏–≥–∏/—Å–µ–∫—Ä–µ—Ç—ã**:    
    - `ConfigMap` –¥–ª—è non-secret (feature flags, URLs).        
    - `Secret` –¥–ª—è –ø–∞—Ä–æ–ª–µ–π/–∫–ª—é—á–µ–π (Kafka, Postgres, SMTP), –º–æ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ env.
    
7. **–î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞**:    
    - –ù–∞ `dev` ‚Äî kubectl RW; –Ω–∞ `test/stage` ‚Äî —á–∞—â–µ RO. –û–ø–µ—Ä–∞—Ü–∏–∏ –¥–µ–ø–ª–æ—è –¥–µ–ª–∞–µ—Ç **Jenkins SA** —á–µ—Ä–µ–∑ RBAC.
    
8. **Rollback**:    
    - `helm rollback <release> <revision>` –ª–∏–±–æ –∑–∞–¥–∞—ë–º –ø—Ä–æ—à–ª—ã–π `image.tag`, –ø–æ—Å–ª–µ —á–µ–≥–æ —Ç–æ—Ç –∂–µ rolling update –Ω–∞–∑–∞–¥.
    
9. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**:    
    - `SecurityContext`, `readOnlyRootFilesystem`, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ capabilities, `NetworkPolicy`.
    
10. **–†–µ—Å—É—Ä—Å—ã –∏ –∞–≤—Ç–æ-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**:    

- `resources.requests/limits`, **HPA** –ø–æ CPU/RAM/–∫–∞—Å—Ç–æ–º–Ω—ã–º –º–µ—Ç—Ä–∏–∫–∞–º.    

---
## 5) –ö—Ç–æ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –ø–æ—Å—Ç–∞–≤–∫—É –Ω–∞ —Ç–µ—Å—Ç –∏ –∫–∞–∫ –∏–º–µ–Ω–Ω–æ

- üß∑ **–¢—Ä–∏–≥–≥–µ—Ä ‚Äî merge –≤ `test`** (–∏–Ω–∏—Ü–∏–∞—Ç–æ—Ä –ø–æ—Å—Ç–∞–≤–∫–∏ ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–º–µ—Ä–∂–∏–ª PR).
    
- üßë‚Äçüíº **–†—É—á–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–π** –¥–ª—è `test` –Ω–µ—Ç; –¥–ª—è `stage/prod` ‚Äî manual approval (—Ç–∏–º–ª–∏–¥/DevOps).
    
- üîê Jenkins –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **ServiceAccount** —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ `test` namespace.    

---
## 6) –ö—Ç–æ –ø–∏—Å–∞–ª pipeline/—á–∞—Ä—Ç—ã –∏ –º–æ—è —Ä–æ–ª—å

- üõ†Ô∏è **Helm-chart, Jenkinsfile** ‚Äî –±–∞–∑–æ–≤–æ DevOps.
    
- ‚úçÔ∏è –Ø —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª **values** (—Ä–µ—Å—É—Ä—Å—ã, probes, env), –¥–æ–±–∞–≤–ª—è–ª **Helm-hook** –ø–æ–¥ Liquibase, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–ª **readiness** (—á—Ç–æ–±—ã –Ω–µ –ø—É—Å–∫–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫, –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ–≥—Ä–µ–ª—Å—è –ø—É–ª, –Ω–µ –ø–æ–¥–Ω—è–ª–∞—Å—å Kafka/Redis), –ø—Ä–∞–≤–∏–ª **Jenkinsfile** (smoke-—Ç–µ—Å—Ç—ã, –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, fail-fast).    

---
## 7) –ö–∞–∫ API ¬´—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º¬ª –∏ –∫–∞–∫ —è –µ–≥–æ –ø—Ä–æ–≤–µ—Ä—è—é

- üåê **Ingress** –ø—É–±–ª–∏–∫—É–µ—Ç –º–∞—Ä—à—Ä—É—Ç –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –¥–æ–º–µ–Ω–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä `https://test.company.local/notify`.
    
- üìú **Swagger/OpenAPI** –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ `‚Ä¶/swagger-ui` (–ª–∏–±–æ —á–µ—Ä–µ–∑ API-gateway).
    
- üëÄ –ü—Ä–æ–≤–µ—Ä–∫–∏:
    
    - `GET /actuator/health` (readiness).
        
    - –ù–∞–±–æ—Ä **smoke-—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤** (Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è) ‚Äî 200/4xx/5xx –ø–æ–≤–µ–¥–µ–Ω–∏–µ.
        
    - –õ–æ–≥–∏ –∏ —Ç—Ä–µ–π—Å–∏–Ω–≥ (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ `X-Request-Id`).
        
    - Kafka round-trip (–µ—Å–ª–∏ —Å–æ–±—ã—Ç–∏–π–Ω–∞—è —á–∞—Å—Ç—å –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω–∞).
        

---
### –†–µ–∑—é–º–µ –¥–ª—è –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑—É—é **Helm-–±–∞–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π CD** —á–µ—Ä–µ–∑ **Jenkins**; –ø–æ–Ω–∏–º–∞—é –≤–µ—Å—å –ø—É—Ç—å: image ‚Üí Deployment/RS ‚Üí Probes ‚Üí Service ‚Üí Ingress.
    
- –£–º–µ—é **–¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** (events/logs/describe), **—Ä—É–ª–∏—Ç—å** –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ (Helm-hooks/Liquibase), **–¥–µ–ª–∞—Ç—å rollback**, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã/HPA –∏ **observability**.

---

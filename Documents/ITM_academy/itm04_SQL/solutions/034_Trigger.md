# –ß—Ç–æ —Ç–∞–∫–æ–µ ¬´—Ç—Ä–∏–≥–≥–µ—Ä¬ª?

üìå¬†**–¢—Ä–∏–≥–≥–µ—Ä**¬†‚Äî —ç—Ç–æ –æ—Å–æ–±—ã–π –≤–∏–¥ —Ö—Ä–∞–Ω–∏–º–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã, –∫–æ—Ç–æ—Ä–∞—è¬†**–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**¬†–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ:

---
### ‚ú® –ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä?
–¢–æ–ª—å–∫–æ –ø—Ä–∏ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö:
‚úî¬†**INSERT**¬†(_–≤—Å—Ç–∞–≤–∫–∞_)  
‚úî¬†**UPDATE**¬†(_–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ_)  
‚úî¬†**DELETE**¬†(_—É–¥–∞–ª–µ–Ω–∏–µ_)
‚ùó –ù–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é.

---
# ‚è≥ –ú–æ–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚è≥¬†**BEFORE**¬†‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è¬†**–¥–æ**¬†–∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚è≥¬†**AFTER**¬†‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è¬†**–ø–æ—Å–ª–µ**¬†–∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
###### üí° –í–∞–∂–Ω–æ: —Ç—Ä–∏–≥–≥–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç **–≤ —Ä–∞–º–∫–∞—Ö —Ç–æ–π –∂–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**, —á—Ç–æ –∏ –≤—ã–∑–≤–∞–≤—à–∏–π –µ–≥–æ –∑–∞–ø—Ä–æ—Å. –ï—Å–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–∫–∞—Ç–∏—Ç—Å—è ‚Äî –æ—Ç–∫–∞—Ç—è—Ç—Å—è –∏ –¥–µ–π—Å—Ç–≤–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–∞.

---
# üîé –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–º**    
- –ú–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫:    
    - `NEW` ‚Äî –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏        
    - `OLD` ‚Äî —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏        
- –ú–æ–∂–µ—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ª–æ–≥–∏–∫–∏ –°–£–ë–î)

---
### üõ† –ü—Ä–∏–º–µ—Ä —Ç—Ä–∏–≥–≥–µ—Ä–∞
üëâ¬†**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏–π**:
```sql
CREATE TRIGGER before_delete_user
BEFORE DELETE ON users
FOR EACH ROW
INSERT INTO users_log(user_id, action) 
VALUES (OLD.id, 'deleted');
```
üîπ –≠—Ç–æ—Ç —Ç—Ä–∏–≥–≥–µ—Ä¬†**–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç ID —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ª–æ–≥**¬†–ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º.

---
# ‚ö† –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ä–∏—Å–∫–∏
- –£—Å–ª–æ–∂–Ω—è—é—Ç –æ—Ç–ª–∞–¥–∫—É    
- –ú–æ–≥—É—Ç –Ω–µ–∑–∞–º–µ—Ç–Ω–æ –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å    
- –õ–æ–≥–∏–∫–∞ ¬´—Å–ø—Ä—è—Ç–∞–Ω–∞¬ª –≤–Ω—É—Ç—Ä–∏ –ë–î    
- –í–æ–∑–º–æ–∂–Ω—ã —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã    

üß† **–ü—Ä–∞–≤–∏–ª–æ**: –ß–µ–º –±–æ–ª—å—à–µ —Å–∫—Ä—ã—Ç–æ–π –ª–æ–≥–∏–∫–∏ –≤ –ë–î ‚Äî —Ç–µ–º —Å–ª–æ–∂–Ω–µ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ.

---
# üìå –ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç –¥–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è
> –¢—Ä–∏–≥–≥–µ—Ä ‚Äî —ç—Ç–æ —Ö—Ä–∞–Ω–∏–º–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ INSERT, UPDATE –∏–ª–∏ DELETE.  
> –û–Ω –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ–∫—É—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è BEFORE –∏–ª–∏ AFTER —Å–æ–±—ã—Ç–∏—è.  
> –ò—Å–ø-—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞, –∫–æ–Ω—Ç—Ä–æ–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ –∞–≤—Ç–æ–º-—Ü–∏–∏ –ª–æ–≥–∏–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î.

---

```
***** –∏–∑ –º–µ—Ç–æ–¥–∏—á–∫–∏ *****
–¢—Ä–∏–≥–≥–µ—Ä (trigger) ‚Äî —ç—Ç–æ —Ö—Ä–∞–Ω–∏–º–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ, –∞ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è (–≤—Å—Ç–∞–≤–∫–∞, —É–¥–∞–ª–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ / —ç—Ç–æ —Ö—Ä–∞–Ω–∏–º–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ—Å–æ–±–æ–≥–æ —Ç–∏–ø–∞, –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–π –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ–º –ø–æ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º, —É–¥–∞–ª–µ–Ω–∏–µ–º –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö 
–≤ –∑–∞–¥–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. 

–¢—Ä–∏–≥–≥–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –≤—Å–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–µ –∏–º –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –∫–∞–∫ –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ, –≤—ã–∑–≤–∞–≤—à–µ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞.

–ú–æ–º–µ–Ω—Ç –∑–∞–ø—É—Å–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ BEFORE (—Ç—Ä–∏–≥–≥–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ —Å –Ω–∏–º —Å–æ–±—ã—Ç–∏—è) –∏–ª–∏ AFTER (–ø–æ—Å–ª–µ —Å–æ–±—ã—Ç–∏—è).
```

---

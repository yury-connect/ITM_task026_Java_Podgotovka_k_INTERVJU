# –ö–∞–∫ –≤–ª–∏—è–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—è `persist` –Ω–∞ `Entity` –æ–±—ä–µ–∫—Ç—ã –∫–∞–∂–¥–æ–≥–æ –∏–∑ —á–µ—Ç—ã—Ä–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤?

---
## üß© –í–ª–∏—è–Ω–∏–µ `persist()` –Ω–∞ `Entity` –≤ —Ä–∞–∑–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö

|**–°—Ç–∞—Ç—É—Å** `Entity`|**–ü–æ–≤–µ–¥–µ–Ω–∏–µ** `persist(entity)`|
|---|---|
|`Transient` üÜï|‚úÖ –°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `Managed`  <br>üîÑ –í—Å—Ç–∞–≤–∫–∞ –≤ –ë–î –ø—Ä–∏ `flush()` –∏–ª–∏ `commit()`|
|`Managed` ‚úÖ|üîÅ –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è  <br>‚ö† –û–¥–Ω–∞–∫–æ, –∫–∞—Å–∫–∞–¥–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`CascadeType.PERSIST`) –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã|
|`Detached` üîå|‚ùå –ë—Ä–æ—Å–∞–µ—Ç—Å—è `EntityExistsException`  <br>(_–ª–∏–±–æ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ, –ª–∏–±–æ –ø—Ä–∏ –∫–æ–º–º–∏—Ç–µ_)|
|`Removed` üóë|‚ö† –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å —Å—É—â–Ω–æ—Å—Ç—å –≤ `Managed`  <br>–¢–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ–∫—É—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏|
## –°–æ—Å—Ç–æ—è–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–∏ –≤ JPA
–í JPA —Å—É—â–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π:
1. **Transient** (_–ù–æ–≤–∞—è_): –°—É—â–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏–∏ –∏ –Ω–µ –∏–º–µ–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
2. **Managed** (_–£–ø—Ä–∞–≤–ª—è–µ–º–∞—è_): –°—É—â–Ω–æ—Å—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å –∞–∫—Ç–∏–≤–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏–∏; –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.
3. **Detached** (_–û—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–Ω–∞—è_): –°—É—â–Ω–æ—Å—Ç—å —Ä–∞–Ω–µ–µ –±—ã–ª–∞ —É–ø—Ä–∞–≤–ª—è–µ–º–æ–π, –Ω–æ —Ç–µ–ø–µ—Ä—å –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å —Ç–µ–∫—É—â–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏–∏; –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è.
4. **Removed** (_–£–¥–∞–ª–µ–Ω–Ω–∞—è_): –°—É—â–Ω–æ—Å—Ç—å –ø–æ–º–µ—á–µ–Ω–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö; —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏–∏.

## üß† –°–æ—Å—Ç–æ—è–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–∏ –∏ –∏—Ö –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ JPA-–æ–ø–µ—Ä–∞—Ü–∏—è—Ö

| üõ†Ô∏è **–û–ø–µ—Ä–∞—Ü–∏—è \ üì¶ –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏** | üå± **Transient** (_–ù–æ–≤–∞—è_)                            | üü¢ **Managed** (_–£–ø—Ä–∞–≤–ª—è–µ–º–∞—è_)                                   | üîå **Detached** (_–û—Ç—Å–æ–µ–¥–∏–Ω—ë–Ω–Ω–∞—è_)                                    | üóëÔ∏è **Removed** (_–£–¥–∞–ª—ë–Ω–Ω–∞—è_)                         |
| ---------------------------------------- | ----------------------------------------------------- | ---------------------------------------------------------------- | -------------------------------------------------------------------- | ----------------------------------------------------- |
| **`persist()` üèóÔ∏è**                          | ‚òëÔ∏è –°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è Managed; SQL `INSERT` –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ | üîÑ –ë–µ–∑ —ç—Ñ—Ñ–µ–∫—Ç–∞                                                   | ‚ùå `IllegalArgumentException`                                         | ‚ôªÔ∏è –°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è Managed; SQL `INSERT` –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ |
| **`remove()` üßπ**                            | ‚ùå `IllegalArgumentException`                          | üóëÔ∏è –°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è Removed; SQL `DELETE` –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏           | ‚ùå `IllegalArgumentException`                                         | üôà –ë–µ–∑ —ç—Ñ—Ñ–µ–∫—Ç–∞                                        |
| **`merge()` üß¨**                             | ‚òëÔ∏è –°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è Managed; SQL `INSERT` –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ | üîÑ –ë–µ–∑ —ç—Ñ—Ñ–µ–∫—Ç–∞                                                   | üîÑ –°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è Managed; –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö; SQL `INSERT` –∏–ª–∏ `UPDATE` | ‚ùå `IllegalArgumentException`                          |
| **`refresh()` ‚ôªÔ∏è**                           | ‚ùå `EntityNotFoundException`                           | üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –∏–∑ –ë–î; –≤–æ–∑–º–æ–∂–Ω—ã –æ—à–∏–±–∫–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–ø–∏—Å–∏ | ‚ùå `IllegalArgumentException`                                         | ‚ùå `EntityNotFoundException`                           |
| **`detach()` ‚úÇÔ∏è**                            | üôà –ë–µ–∑ —ç—Ñ—Ñ–µ–∫—Ç–∞                                        | üîå –°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è Detached; –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è               | üôà –ë–µ–∑ —ç—Ñ—Ñ–µ–∫—Ç–∞                                                       | üîå –°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è Detached; –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è    |
## **–ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ –æ–ø–µ—Ä–∞—Ü–∏—è–º**
- `persist`: –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—É—é —Å—É—â–Ω–æ—Å—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
- `remove`: –ü–æ–º–µ—á–∞–µ—Ç —É–ø—Ä–∞–≤–ª—è–µ–º—É—é —Å—É—â–Ω–æ—Å—Ç—å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–º —Å—É—â–Ω–æ—Å—Ç—è–º.
- `merge`: –ö–æ–ø–∏—Ä—É–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ –≤ —É–ø—Ä–∞–≤–ª—è–µ–º—É—é —Å—É—â–Ω–æ—Å—Ç—å. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.
- `refresh`: –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É–ø—Ä–∞–≤–ª—è–µ–º–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç–º–µ–Ω—ã –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π.
- `detach`: –û—Ç—Å–æ–µ–¥–∏–Ω—è–µ—Ç —Å—É—â–Ω–æ—Å—Ç—å –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏–∏, –ø—Ä–µ–∫—Ä–∞—â–∞—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

---

```
***** –∏–∑ –º–µ—Ç–æ–¥–∏—á–∫–∏ *****
new ‚Üí managed, –∏ –æ–±—ä–µ–∫—Ç –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω 
–≤ –±–∞–∑—É –ø—Ä–∏ commit-–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–ª–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ flush –æ–ø–µ—Ä–∞—Ü–∏–π
managed ‚Üí –æ–ø–µ—Ä–∞—Ü–∏—è –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –æ–¥–Ω–∞–∫–æ –∑–∞–≤–∏—Å–∏–º—ã–µ Entity 
–º–æ–≥—É—Ç –ø–æ–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ managed, –µ—Å–ª–∏ —É –Ω–∏—Ö –µ—Å—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∫–∞—Å–∫–∞–¥–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
detached ‚Üí exception —Å—Ä–∞–∑—É –∏–ª–∏ –Ω–∞ —ç—Ç–∞–ø–µ commit-–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
removed ‚Üí managed, –Ω–æ —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. 
```

---

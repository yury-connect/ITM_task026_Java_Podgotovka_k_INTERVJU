# –ö–∞–∫–∏–µ —à–µ—Å—Ç—å –≤–∏–¥–æ–≤ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (lock) –æ–ø–∏—Å–∞–Ω—ã –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ JPA (–∏–ª–∏ –∫–∞–∫–∏–µ –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —É enum LockModeType –≤ JPA)?

---
## –ö–∞–∫–∏–µ —à–µ—Å—Ç—å –≤–∏–¥–æ–≤ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (_lock_) –æ–ø–∏—Å–∞–Ω—ã –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ JPA  
(_–∏–ª–∏ –∫–∞–∫–∏–µ –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —É enum LockModeType –≤ JPA_)?

[](https://github.com/yury-connect/ITM_task026_Java_Podgotovka_k_INTERVJU/blob/by_questions/ITM/ITM05_Hibernate/Hibernate.md#%D0%BA%D0%B0%D0%BA%D0%B8%D0%B5-%D1%88%D0%B5%D1%81%D1%82%D1%8C-%D0%B2%D0%B8%D0%B4%D0%BE%D0%B2-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BE%D0%BA-lock-%D0%BE%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D1%8B-%D0%B2-%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8-jpa-%D0%B8%D0%BB%D0%B8-%D0%BA%D0%B0%D0%BA%D0%B8%D0%B5-%D0%B5%D1%81%D1%82%D1%8C-%D0%B7%D0%BD%D0%B0%D1%87%D0%B5%D0%BD%D0%B8%D1%8F-%D1%83-enum-lockmodetype-%D0%B2-jpa)

## üîê LockModeType –≤ JPA ‚Äî –†–µ–∂–∏–º—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

[](https://github.com/yury-connect/ITM_task026_Java_Podgotovka_k_INTERVJU/blob/by_questions/ITM/ITM05_Hibernate/Hibernate.md#-lockmodetype-%D0%B2-jpa--%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D1%8B-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8)

JPA –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç¬†**6**¬†—É—Ä–æ–≤–Ω–µ–π –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –≤¬†`enum javax.persistence.LockModeType`.  
–û–Ω–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –ø–æ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å—Ü–µ–Ω–∞—Ä–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –æ—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ - –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é—Ç, —á—Ç–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –±—É–¥–µ—Ç –º–∞–ª–æ –ø–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ - —á—Ç–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–æ–∑–º–æ–∂–Ω–æ –±—É–¥–µ—Ç –º–Ω–æ–≥–æ –∏ –Ω—É–∂–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—é –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

---

### üìã –¢–∞–±–ª–∏—Ü–∞: —Ä–µ–∂–∏–º—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ JPA

[](https://github.com/yury-connect/ITM_task026_Java_Podgotovka_k_INTERVJU/blob/by_questions/ITM/ITM05_Hibernate/Hibernate.md#-%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0-%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D1%8B-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8-%D0%B2-jpa)

|**üî¢**|**LockModeType**|**–¢–∏–ø –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏**|**–û–ø–∏—Å–∞–Ω–∏–µ**|
|---|---|---|---|
|1Ô∏è‚É£|`NONE`|üîì –ë–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏|–î–∞–Ω–Ω—ã–µ —á–∏—Ç–∞—é—Ç—Å—è –±–µ–∑ –Ω–∞–ª–æ–∂–µ–Ω–∏—è –∫–∞–∫–∏—Ö-–ª–∏–±–æ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.|
|2Ô∏è‚É£|`OPTIMISTIC`|‚úÖ –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è|–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—è¬†`@Version`¬†_(–≤–µ—Ä—Å–∏–∏ —Å—É—â–Ω–æ—Å—Ç–∏)_¬†–ø—Ä–∏¬†`commit`.  <br>–ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å ‚Äî¬†`OptimisticLockException`.|
|3Ô∏è‚É£|`OPTIMISTIC_FORCE_INCREMENT`|üîÅ –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è  <br>+ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç|–ê–Ω–∞–ª–æ–≥¬†`OPTIMISTIC`, –Ω–æ –ø–æ–ª–µ¬†`@Version`¬†—É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è¬†**–≤—Å–µ–≥–¥–∞**, –¥–∞–∂–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.|
|4Ô∏è‚É£|`PESSIMISTIC_READ`|üîí –ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–∞—è  <br>(_—á—Ç–µ–Ω–∏–µ_)|–î–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –Ω–∞ —á—Ç–µ–Ω–∏–µ.  <br>–î—Ä—É–≥–∏–µ –º–æ–≥—É—Ç¬†**—á–∏—Ç–∞—Ç—å**, –Ω–æ¬†**–Ω–µ –∏–∑–º–µ–Ω—è—Ç—å**.|
|5Ô∏è‚É£|`PESSIMISTIC_WRITE`|üîê –ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–∞—è  <br>(_–∑–∞–ø–∏—Å—å_)|–î–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é.  <br>**–ù–∏ —á—Ç–µ–Ω–∏–µ**,¬†**–Ω–∏ –∑–∞–ø–∏—Å—å**¬†–¥—Ä—É–≥–∏–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏¬†**–Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã**.|
|6Ô∏è‚É£|`PESSIMISTIC_FORCE_INCREMENT`|üîê‚ûï –ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–∞—è  <br>+ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç|–ö–∞–∫¬†`PESSIMISTIC_WRITE`, –Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç¬†`@Version`.|
|7Ô∏è‚É£|`READ`¬†(_—É—Å—Ç–∞—Ä–µ–≤—à–∏–π_)|üìñ –°–∏–Ω–æ–Ω–∏–º¬†`OPTIMISTIC`.|_—É—Å—Ç–∞—Ä–µ–≤—à–∏–π_  <br>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å  <br>`OPTIMISTIC`¬†–≤ –Ω–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.|
|8Ô∏è‚É£|`WRITE`¬†(_—É—Å—Ç–∞—Ä–µ–≤—à–∏–π_)|‚úèÔ∏è –°–∏–Ω–æ–Ω–∏–º¬†`OPTIMISTIC_FORCE_INCREMENT`.|_—É—Å—Ç–∞—Ä–µ–≤—à–∏–π_  <br>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å¬†`<br>OPTIMISTIC_FORCE_INCREMENT`¬†–≤ –Ω–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.|

---

### ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

[](https://github.com/yury-connect/ITM_task026_Java_Podgotovka_k_INTERVJU/blob/by_questions/ITM/ITM05_Hibernate/Hibernate.md#%EF%B8%8F-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8)

```java
EntityManager em = entityManagerFactory.createEntityManager();
em.getTransaction().begin();

Company company = em.find(Company.class, 1L);
em.lock(company, LockModeType.OPTIMISTIC);

em.getTransaction().commit();
```

---

## üß† –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (_Optimistic Lock_)

[](https://github.com/yury-connect/ITM_task026_Java_Podgotovka_k_INTERVJU/blob/by_questions/ITM/ITM05_Hibernate/Hibernate.md#-%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%BD%D0%B0%D1%8F-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0-optimistic-lock)

- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –ë–î.
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª–µ¬†`@Version`¬†–ø—Ä–∏ –∫–æ–º–º–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
- –ò–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º —Å¬†**–Ω–∏–∑–∫–∏–º —É—Ä–æ–≤–Ω–µ–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –¥–æ—Å—Ç—É–ø–∞**.

```java
@Version
private long version;
```

üß™ –ü—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –≤–µ—Ä—Å–∏–π ‚Äî¬†`OptimisticLockException`.

---

## üß± –ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (_Pessimistic Lock_)

[](https://github.com/yury-connect/ITM_task026_Java_Podgotovka_k_INTERVJU/blob/by_questions/ITM/ITM05_Hibernate/Hibernate.md#-%D0%BF%D0%B5%D1%81%D1%81%D0%B8%D0%BC%D0%B8%D1%81%D1%82%D0%B8%D1%87%D0%BD%D0%B0%D1%8F-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0-pessimistic-lock)

- –ê–∫—Ç–∏–≤–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –º–æ–º–µ–Ω—Ç —á—Ç–µ–Ω–∏—è –∏–ª–∏ –∑–∞–ø–∏—Å–∏.
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∑–∞—â–∏—Ç—É –æ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏¬†**–≤—ã—Å–æ–∫–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏**¬†–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–æ–ª—è—Ü–∏–∏.

üìå –¢—Ä–µ–±—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ë–î.

---

## üÜö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ:¬†`Optimistic`¬†vs¬†`Pessimistic`

[](https://github.com/yury-connect/ITM_task026_Java_Podgotovka_k_INTERVJU/blob/by_questions/ITM/ITM05_Hibernate/Hibernate.md#-%D1%81%D1%80%D0%B0%D0%B2%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5-optimistic-vs-pessimistic)

|**–ö—Ä–∏—Ç–µ—Ä–∏–π**|`Optimistic`|`Pessimistic`|
|---|---|---|
|–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤ –ë–î|‚ùå –ù–µ—Ç|‚úÖ –î–∞|
|–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å|üîº –í—ã—à–µ|üîΩ –ù–∏–∂–µ|
|–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã|–û–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∫–æ–º–º–∏—Ç–µ|–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ|
|–†–∏—Å–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π|`OptimisticLockException`|`PessimisticLockException`, deadlock|
|–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è|–ß—Ç–µ–Ω–∏–µ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º|–í—ã—Å–æ–∫–æ–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º|

> **üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–π¬†`OPTIMISTIC`,  
> –∞¬†`PESSIMISTIC`¬†‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏¬†_—Å—Ç—Ä–æ–≥–æ–π –∏–∑–æ–ª—è—Ü–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π_.**

---

```
***** –∏–∑ –º–µ—Ç–æ–¥–∏—á–∫–∏ *****
–í –ø–æ—Ä—è–¥–∫–µ –æ—Ç —Å–∞–º–æ–≥–æ –Ω–µ–Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∏ –±—ã—Å—Ç—Ä–æ–≥–æ, –¥–æ —Å–∞–º–æ–≥–æ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∏ –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ:
1.        NONE ‚Äî –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.
2.        OPTIMISTIC (—Å–∏–Ω–æ–Ω–∏–º READ –≤ JPA 1) ‚Äî –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–∞—è  –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç–∞–∫: 
            –µ—Å–ª–∏ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∫—Ç–æ-—Ç–æ –∏–∑–≤–Ω–µ –∏–∑–º–µ–Ω–∏—Ç –ø–æ–ª–µ @Version, 
            —Ç–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω RollBack —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –±—É–¥–µ—Ç –≤—ã–±—Ä–æ—à–µ–Ω–æ OptimisticLockException.
3.        OPTIMISTIC_FORCE_INCREMENT (—Å–∏–Ω–æ–Ω–∏–º WRITE –≤ JPA 1) ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Ç–æ–º—É –∂–µ –∞–ª–≥–æ—Ä–∏—Ç–º—É, 
            —á—Ç–æ –∏ LockModeType.OPTIMISTIC –∑–∞ —Ç–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º, —á—Ç–æ –ø–æ—Å–ª–µ commit –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª–µ Version 
            –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 1. –í –∏—Ç–æ–≥–µ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ –ø–æ–ª–µ —É–≤–µ–ª–∏—á–∏—Ç—Å—è 
            –Ω–∞ 2(—É–≤–µ–ª–∏—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –≤ Post-Update + –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ).
4.        PESSIMISTIC_READ ‚Äî –¥–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –≤ –º–æ–º–µ–Ω—Ç —á—Ç–µ–Ω–∏—è –∏ —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –Ω–∏–∫—Ç–æ 
            –≤ —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ —Å–º–æ–∂–µ—Ç –∏—Ö –∏–∑–º–µ–Ω–∏—Ç—å. –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ, 
            —Å–º–æ–≥—É—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —á–∏—Ç–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å 
            –¥–æ–ª–≥–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏–ª–∏ –¥–∞–∂–µ –≤—ã–∫–∏–¥—ã–≤–∞–Ω–∏–µ PessimisticLockException.
5.        PESSIMISTIC_WRITE ‚Äî –¥–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –≤ –º–æ–º–µ–Ω—Ç –∑–∞–ø–∏—Å–∏ –∏ –Ω–∏–∫—Ç–æ —Å –º–æ–º–µ–Ω—Ç–∞ –∑–∞—Ö–≤–∞—Ç–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ 
            –Ω–µ –º–æ–∂–µ—Ç –≤ –Ω–∏—Ö –ø–∏—Å–∞—Ç—å –∏ –Ω–µ –º–æ–∂–µ—Ç –∏—Ö —á–∏—Ç–∞—Ç—å –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤–ª–∞–¥–µ—é—â–µ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π. 
            –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –¥–æ–ª–≥–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.
6.        PESSIMISTIC_FORCE_INCREMENT ‚Äî –≤–µ–¥—ë—Ç —Å–µ–±—è –∫–∞–∫ PESSIMISTIC_WRITE, –Ω–æ –≤ –∫–æ–Ω—Ü–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ 
            —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è @Version, –¥–∞–∂–µ –µ—Å–ª–∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å—É—â–Ω–æ—Å—Ç—å –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å.

–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ - –ø–æ–¥—Ö–æ–¥ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—â–∏–µ—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ 
—Ä–µ–¥–∫–æ –æ–±—Ä–∞—â–∞—é—Ç—Å—è –∫ –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ –¥–∞–Ω–Ω—ã–º –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º —Å–≤–æ–±–æ–¥–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ª—é–±—ã–µ —á—Ç–µ–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. 
–ù–æ –ø—Ä–∏ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞, –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏, 
–µ—Å–ª–∏ –¥–∞, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è –∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è OptimisticLockException. 
–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JPA —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—É—Ç—ë–º –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤ —Å—É—â–Ω–æ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—è –≤–µ—Ä—Å–∏–∏:
    @Version
    private long version;
–ü–æ–ª–µ, –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ @Version, –º–æ–∂–µ—Ç –±—ã—Ç—å —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω–´–º. 
–ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –µ—Å–ª–∏ —Å—É—â–Ω–æ—Å—Ç—å –±—ã–ª–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ, –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ, 
–Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ @Version –∫–µ–º-–ª–∏–±–æ –µ—â—ë, –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω—ã, –∏, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å, 
–±—É–¥–µ—Ç –≤—ã–∫–∏–Ω—É—Ç–æ OptimisticLockException. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–æ–ª—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ 
–Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Å–¥–µ–ª–∞—Ç—å –≤—Å—ë –Ω–∞ —É—Ä–æ–≤–Ω–µ JPA, —É–ª—É—á—à–∞—è —É—Ä–æ–≤–µ–Ω—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏.
–ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–∫–∞–∑–∞—Ç—å—Å—å –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î –∏ –¥–µ–ª–∞—Ç—å –≤—Å—ë —Å JPA.

–ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ - –ø–æ–¥—Ö–æ–¥ –Ω–∞–ø—Ä–æ—Ç–∏–≤, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—Ç 
–∑–∞ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ—ç—Ç–æ–º—É –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –≤ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç –∫–æ–≥–¥–∞ —á–∏—Ç–∞–µ—Ç –∏—Ö. 
–î—Ä—É–≥–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è, –∫–æ–≥–¥–∞ –ø—ã—Ç–∞—é—Ç—Å—è –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º 
–∏ –∂–¥—É—Ç —Å–Ω—è—Ç–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–∏–ª–∏ –∫–∏–¥–∞—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ). 
–ü–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –∏ –ø–æ—ç—Ç–æ–º—É –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤ –≤ –∫–æ–¥ —Å—É—â–Ω–æ—Å—Ç–∏.

–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å—Ç–∞–≤—è—Ç—Å—è –ø—É—Ç—ë–º –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞ lock() —É EntityManager, 
–≤ –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Å—É—â–Ω–æ—Å—Ç—å, —Ç—Ä–µ–±—É—é—â–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏ —É—Ä–æ–≤–µ–Ω—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:
EntityManager em = entityManagerFactory.createEntityManager();
em.lock(company1, LockModeType.OPTIMISTIC);
```

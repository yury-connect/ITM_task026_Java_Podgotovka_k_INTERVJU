# Stack –∏ Heap

- üîπ**Stack**¬†_(—Å—Ç–µ–∫)_¬†‚Äì –∏—Å–ø. –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è¬†_stack frame'–æ–≤_, —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Å—Ö–µ–º–µ¬†`LIFO`.

> –°–æ–¥–µ—Ä–∂–∏—Ç:  
> - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ—Ç–æ–¥–∞,
> - —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ñ—Ä–µ–π–º –∏
> - –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

- üîπ**Heap**¬†_(–∫—É—á–∞)_¬†‚Äì –≠—Ç–∞ –æ–±–ª–∞—Å—Ç—å –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –∫–ª–∞—Å—Å–æ–≤¬†_JRE_¬†–≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.  
    / –ù–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤¬†**–∫—É—á–µ**, –∞ —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–∏—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –≤¬†**—Å—Ç–µ–∫–µ**.  
    / –≠—Ç–∏ –æ–±—ä–µ–∫—Ç—ã –∏–º–µ—é—Ç¬†**–≥–ª–æ–±–∞–ª—å–Ω—ã–π**¬†–¥–æ—Å—Ç—É–ø –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω—ã –∏–∑¬†**–ª—é–±–æ–≥–æ**¬†–º–µ—Å—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã.  
    / –°—Ç—Ä—É–∫—Ç—É—Ä–∞¬†**Heap**¬†–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ¬†`GC`¬†(_Serial, Parallel, CMS, G1_).  
    / –†–∞–∑–º–µ—Ä —Å—Ç–µ–∫–∞¬†**–º–µ–Ω—å—à–µ**, –Ω–æ –æ–Ω¬†**–±—ã—Å—Ç—Ä–µ–µ**¬†–∫—É—á–∏.

_**–ù–∞—á–∞–ª—å–Ω—ã–π**¬†—Ä–∞–∑–º–µ—Ä (Xms) =¬†**1/64**¬†—Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏ –º–∞—à–∏–Ω—ã (–∏–ª–∏ –Ω–µ–∫-–≥–æ —Ä–∞–∑—É–º–Ω–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞).  
**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π**¬†—Ä–∞–∑–º–µ—Ä (Xmx):¬†**1/4**¬†—Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏ –º–∞—à–∏–Ω—ã (–∏–ª–∏ 1 –ì–±. –î–æ –≤–µ—Ä—Å–∏–∏ 1.5 = 64 –ú–±)._

**–û–±–µ**¬†–æ–±–ª–∞—Å—Ç–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤¬†**RAM**.  
**–û—à–∏–±–∫–∏**¬†–ø–∞–º—è—Ç–∏:¬†`StackOverflowError`¬†(_–ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ¬†**—Å—Ç–µ–∫–∞**_),¬†`OutOfMemoryError`¬†(_–ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ¬†**–∫—É—á–∏**_).

üí°¬†**Heap**¬†—Ä–∞–∑–±–∏—Ç –Ω–∞ —á–∞—Å—Ç–∏ (–ø–æ–∫–æ–ª–µ–Ω–∏—è¬†_Generation_):

![|578x207](./_Attachments_itm1025_Stack_Heap/2025-02-24_23-16-12.png)

- **Young Generation**¬†‚Äî –æ–±–ª–∞—Å—Ç—å –≥–¥–µ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è¬†**–Ω–µ–¥–∞–≤–Ω–æ**¬†—Å–æ–∑–¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã.  
    –ö–æ–≥–¥–∞ –æ–Ω–∞ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±—ã—Å—Ç—Ä–∞—è¬†_—Å–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞_¬†Old (Tenured)
- **Old Generation**¬†‚Äî –∑–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ –æ–±—ä–µ–∫—Ç—ã.  
    –ö–æ–≥–¥–∞ –æ–±—ä–µ–∫—Ç—ã –∏–∑¬†**Young Generation**¬†–¥–æ—Å—Ç–∏–≥–∞—é—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞ ¬´_–≤–æ–∑—Ä–∞—Å—Ç–∞_¬ª, –æ–Ω–∏ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤¬†**Old Generation**
- **Permanent Generation**¬†‚Äî —ç—Ç–∞ –æ–±–ª–∞—Å—Ç—å —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∞—Å—Å–∞—Ö –∏ –º–µ—Ç–æ–¥–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–æ –Ω–∞—á–∏–Ω–∞—è —Å¬†`Java 8`¬†–¥–∞–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏ –±—ã–ª–∞¬†**—É–ø—Ä–∞–∑–¥–Ω–µ–Ω–∞**¬†(_–∫–ª–∞—Å—Å—ã –∏ –º–µ—Ç–æ–¥—ã_).¬†~~–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –Ω–∏–∂–µ:~~

> - ‚úÖ**PermGen**¬†(_Permanent Generation_) ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ¬†**–≤ –∫—É—á–µ**,¬†**–æ—Ç–¥–µ–ª–µ–Ω–Ω–æ–µ**¬†–æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.  
>     –í¬†**PermGen**¬†–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞ —Ö—Ä–∞–Ω–∏—Ç¬†**–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤**.  
>     –¢–∞–∫–∂–µ –∑–¥–µ—Å—å –Ω–∞—Ö–æ–¥—è—Ç—Å—è:
> 
> > - –≤—Å—ë —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è,
> > - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∏
> > - —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã,
> > - —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ¬†**–±–∞–π—Ç–∫–æ–¥–µ**¬†–∏¬†**JIT –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é**.
> 
> –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏ –ø–∞–º—è—Ç–∏:
> 
> > –¥–ª—è¬†**32**-—Ö –±–∏—Ç–Ω–æ–π JVM —Ä–∞–≤–µ–Ω¬†**64 –ú–±**, –∞  
> > –¥–ª—è¬†**64**-—Ö –±–∏—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ ‚Äî¬†**82 –ú–±**.
> 
> `-XX:PermSize=[—Ä–∞–∑–º–µ—Ä]`¬†–¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏¬†**–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ**¬†—Ä–∞–∑–º–µ—Ä–∞¬†**PermGen**¬†–æ–±–ª–∞—Å—Ç–∏,  
> `-XX:MaxPermSize=[—Ä–∞–∑–º–µ—Ä]`¬†–¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏¬†**–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ**¬†—Ä–∞–∑–º–µ—Ä–∞
> 
> –ò–∑-–∑–∞ —Å–≤–æ–µ–≥–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞,¬†**PermGen**¬†—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏—á–∏–Ω–æ–π –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏¬†`java.lang.OutOfMemoryError: PermGen space`.
> 
> - ‚úÖ**Metaspace**¬†‚Äì –Ω–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏, –ø–æ—è–≤–∏–≤—à–∞—è—Å—è –≤¬†`Java 8`¬†–∏ –∑–∞–º–µ–Ω–∏–≤—à–∞—è —É—Å—Ç–∞—Ä–µ–≤—à—É—é¬†**PermGen**.  
>     –û—Å–Ω–æ–≤–Ω–æ–µ –∏—Ö –æ—Ç–ª–∏—á–∏–µ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤¬†**—Å–ø–æ—Å–æ–±–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏**.  
>     / –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é,¬†**Metaspace**¬†—É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è¬†**–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**.  
>     / –ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å¬†**—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é**: –≥—Ä–∞–Ω–∏—Ü—ã –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ø—Ä–∏ –ø–æ–º–æ—â–∏¬†`MetaspaceSize`¬†–∏¬†`MaxMetaspaceSize`.  
>     / –ü—Ä–æ—Ü–µ—Å—Å –æ—á–∏—Å—Ç–∫–∏ –ø–∞–º—è—Ç–∏ –ø–æ–ª—É—á–∏–ª –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:¬†`GC`¬†–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç –Ω–µ–Ω—É–∂–Ω—ã–µ –∫–ª–∞—Å—Å—ã, –∫–æ–≥–¥–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–æ–¥ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è.

![|695x367](./_Attachments_itm1025_Stack_Heap/2025-03-06_10-55-51.png)

```
***** –∏–∑ –º–µ—Ç–æ–¥–∏—á–∫–∏ *****
–ü–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ Stack (—Å—Ç–µ–∫) –∏ Heap (–∫—É—á–∞) :
- Stack —Å–æ–¥–µ—Ä–∂–∏—Ç sta—Åk frame'—ã, –æ–Ω–∏ –¥–µ–ª—è—Ç—Å—è –Ω–∞ —Ç—Ä–∏ —á–∞—Å—Ç–∏: 
    * –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ—Ç–æ–¥–∞,   
    * —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ñ—Ä–µ–π–º    
    * –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Heap –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ 
    —Å–±–æ—Ä—â–∏–∫–∞ –º—É—Å–æ—Ä–∞. –ß–∏—Ç–∞–π –ø—Ä–æ GC!

* MetaSpace - —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∫—É—á–∏, –æ—Ç–¥–µ–ª–µ–Ω–Ω–æ–µ –æ—Ç –∫—É—á–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. 
    JVM —Ö—Ä–∞–Ω–∏—Ç –∑–¥–µ—Å—å –≤–µ—Å—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç. 
    –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –≤—Å–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã, 
    –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã. 
    –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –±–∞–π—Ç-–∫–æ–¥–µ, 
    –∏–º–µ–Ω–∞—Ö –∏ JIT-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. 
    –î–æ Java 7 String Pool —Ç–∞–∫–∂–µ –±—ã–ª —á–∞—Å—Ç—å—é —ç—Ç–æ–π –ø–∞–º—è—Ç–∏. 

–í–∫—Ä–∞—Ç—Ü–µ, –ø—Ä–∏ Serial/ Parallel/ CMS GC –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

–ê –ø—Ä–∏ G1 GC:
–° –ø–æ–º–æ—â—å—é –æ–ø—Ü–∏–π Xms –∏ Xmx –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å 
–Ω–∞—á–∞–ª—å–Ω—ã–π –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–π —Ä–∞–∑–º–µ—Ä –∫—É—á–∏. 
–°—É—â–µ—Å—Ç–≤—É—é—Ç –æ–ø—Ü–∏–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–µ–ª–∏—á–∏–Ω—ã —Å—Ç–µ–∫–∞.

- Heap - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, 
    Stack - –æ–¥–Ω–∏–º –ø–æ—Ç–æ–∫–æ–º –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.
- –ù–æ–≤—ã–π –æ–±—å–µ–∫—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ heap, 
    –≤ stack —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–µ–≥–æ. 
    –í —Å—Ç–µ–∫–µ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö —Ç–∏–ø–æ–≤. 
- –û–±—å–µ–∫—Ç—ã –≤ –∫—É—á–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã, 
    —Å—Ç–µ–∫–æ–≤–∞—è –ø–∞–º—è—Ç—å –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–æ—Ç–æ–∫–æ–≤.
- –ï—Å–ª–∏ –ø–∞–º—è—Ç—å —Å—Ç–µ–∫–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å 
    JRE –≤—ã–∑–æ–≤–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ StackOverflowError, 
    –µ—Å–ª–∏ –∫—É—á–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ OutOfMemoryError
- –†–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏ —Å—Ç–µ–∫–∞, –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ –∫—É—á–∏. 
    –°—Ç–µ–∫–æ–≤–∞—è –ø–∞–º—è—Ç—å –±—ã—Å—Ç—Ä–µ–µ –ø–∞–º—è—Ç–∏ –∫—É—á–∏.
- –í –∫—É—á–µ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏ –º–µ–∂–¥—É –æ–±—ä–µ–∫—Ç–∞–º–∏ –∏ –∏—Ö –∫–ª–∞—Å—Å–∞–º–∏. 
    –ù–∞ —ç—Ç–æ–º –æ—Å–Ω–æ–≤–∞–Ω–∞ —Ä–µ—Ñ–ª–µ–∫—Å–∏—è.

–û–±–µ –æ–±–ª–∞—Å—Ç–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ RAM.
```

---

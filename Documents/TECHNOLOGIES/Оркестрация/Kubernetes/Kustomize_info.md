# **Kustomize**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ `Kubernetes`

---
## **üîπ –ß—Ç–æ —ç—Ç–æ?**
### `Kustomize` ‚Äî —ç—Ç–æ¬†**–Ω–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**¬†–¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ `YAML`-–º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤ `Kubernetes`:
- **–ù–µ —Ç—Ä–µ–±—É–µ—Ç —à–∞–±–ª–æ–Ω–∏–∑–∞—Ü–∏–∏**¬†(*–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç [`Helm`](Helm/Helm_info.md)*).    
- **–†–∞–±–æ—Ç–∞–µ—Ç —Å "—á–∏—Å—Ç—ã–º–∏" YAML**¬†(*–±–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞*).    
- –í—Å—Ç—Ä–æ–µ–Ω –≤¬†`kubectl`¬†(—Å –≤–µ—Ä—Å–∏–∏ 1.14).    

---
## **üîπ –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏**
1. **–ë–∞–∑–æ–≤—ã–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã (*base*)**    
    - –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ YAML-—Ñ–∞–π–ª—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä,¬†`deployment.yaml`,¬†`service.yaml`).        
2. **–û–≤–µ—Ä–ª–µ–∏ (*overlays*)**    
    - –ù–∞–±–æ—Ä—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π (`dev`,¬†`prod`).        
    - –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
```bash
‚îú‚îÄ‚îÄ base/  
‚îÇ   ‚îú‚îÄ‚îÄ deployment.yaml  
‚îÇ   ‚îî‚îÄ‚îÄ kustomization.yaml  
‚îî‚îÄ‚îÄ overlays/  
    ‚îú‚îÄ‚îÄ dev/  
    ‚îÇ   ‚îú‚îÄ‚îÄ kustomization.yaml  # –î–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ–ø–ª–∏–∫–∏=1  
    ‚îî‚îÄ‚îÄ prod/  
        ‚îú‚îÄ‚îÄ kustomization.yaml # –î–æ–±–∞–≤–ª—è–µ—Ç HPA –∏ limits  
```
3. **–ü–∞—Ç—á–∏ (*patches*)**
    - –¢–æ—á–µ—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–µ–ø–ª–∏–∫ –∏–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ env-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö).        

---
## **üîπ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
1. **–°–æ–∑–¥–∞–µ—Ç–µ¬†`kustomization.yaml`**¬†–≤ –±–∞–∑–æ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
```yaml
apiVersion: kustomize.config.k8s.io/v1beta1  
kind: Kustomization  
resources:  
- deployment.yaml  
- service.yaml  
```
    
2. **–î–æ–±–∞–≤–ª—è–µ—Ç–µ –æ–≤–µ—Ä–ª–µ–∏**¬†(–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è¬†`prod`):
```yaml
apiVersion: kustomize.config.k8s.io/v1beta1  
kind: Kustomization  
bases:  
- ../../base  
patchesStrategicMerge:  
- hpa-patch.yaml  # –î–æ–±–∞–≤–ª—è–µ—Ç HorizontalPodAutoscaler  
```
    
3. **–ü—Ä–∏–º–µ–Ω—è–µ—Ç–µ:**
```bash
kubectl apply -k overlays/prod  # –°–æ–±–∏—Ä–∞–µ—Ç –∏ –¥–µ–ø–ª–æ–∏—Ç –∫–æ–Ω—Ñ–∏–≥
```

---
## **üîπ –ü–ª—é—Å—ã**
‚úî¬†**–ü—Ä–æ—Å—Ç–æ—Ç–∞**¬†‚Äî —Ç–æ–ª—å–∫–æ `YAML`, –±–µ–∑ —à–∞–±–ª–æ–Ω–æ–≤.  
‚úî¬†**–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**¬†‚Äî —è–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ –ø–∞—Ç—á–∏.  
‚úî¬†**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Git**¬†‚Äî —É–¥–æ–±–Ω–æ –¥–ª—è GitOps (*ArgoCD, Flux*).  
‚úî¬†**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Kubernetes**¬†‚Äî –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

---
## **üîπ –ú–∏–Ω—É—Å—ã**
‚ùå¬†**–ù–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**¬†(–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç [`Helm`](Helm/Helm_info.md)-—á–∞—Ä—Ç–æ–≤).  
‚ùå¬†**–°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤**¬†‚Äî –º–Ω–æ–≥–æ —Ñ–∞–π–ª–æ–≤.

---
## **üîπ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?**
- **–ù–µ–±–æ–ª—å—à–∏–µ –ø—Ä–æ–µ–∫—Ç—ã**¬†—Å –ø–æ–Ω—è—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.    
- **–ì–∏–±–∫–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**¬†(`dev`/`stage`/`prod`).    
- **–ö–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Ö–æ—Ç—è—Ç [`Helm`](Helm/Helm_info.md)**¬†(*–∏–∑-–∑–∞ –µ–≥–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏*).    

---
## **üîπ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**
```bash
kubectl kustomize overlays/prod  # –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Ç–æ–≥–æ–≤—ã–π YAML  
kubectl apply -k overlays/prod   # –î–µ–ø–ª–æ–π 
```

---
## **üîπ –û—Ç–ª–∏—á–∏–µ –æ—Ç [`Helm`](Helm/Helm_info.md)**

| **–ö—Ä–∏—Ç–µ—Ä–∏–π**        | **Kustomize**              | **[`Helm`](Helm/Helm_info.md)** |
| ------------------- | -------------------------- | -------------------------- |
| **–ü–æ–¥—Ö–æ–¥**          | –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π (YAML-–ø–∞—Ç—á–∏) | –ò–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π (—à–∞–±–ª–æ–Ω—ã Go)  |
| **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** | –ù–µ—Ç                        | –ï—Å—Ç—å (—á–∞—Ä—Ç—ã)               |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å**       | –ù–∏–∑–∫–∞—è                     | –í—ã—Å–æ–∫–∞—è                    |
| **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**      | `kubectl`¬†(–Ω–∞—Ç–∏–≤–Ω–æ)        | –û—Ç–¥–µ–ª—å–Ω—ã–π CLI              |

---
**–ò—Ç–æ–≥:**  
`Kustomize` ‚Äî —ç—Ç–æ¬†**¬´–ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è¬ª –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ [`Helm`](Helm/Helm_info.md)**¬†–¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç:
- –†–∞–±–æ—Ç–∞—Ç—å¬†**—Ç–æ–ª—å–∫–æ —Å `YAML`**.    
- –ò–∑–±–µ–∂–∞—Ç—å —à–∞–±–ª–æ–Ω–∏–∑–∞—Ü–∏–∏.    
- –ë—ã—Å—Ç—Ä–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏—è.    

**–ü—Ä–∏–º–µ—Ä:**
```bash
kubectl apply -k overlays/dev  # –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å dev-–∫–æ–Ω—Ñ–∏–≥
```

---

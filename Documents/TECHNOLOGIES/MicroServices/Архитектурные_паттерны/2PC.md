# **–ü–∞—Ç—Ç–µ—Ä–Ω 2PC** (*Two-Phase Commit*)
**–ú–µ—Ö–∞–Ω–∏–∑–º –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**

---
## **üîπ –°—É—Ç—å**
**2PC** –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ª–∏–±–æ¬†**—Ñ–∏–∫—Å–∏—Ä—É—é—Ç (*commit*)**, –ª–∏–±–æ¬†**–æ—Ç–∫–∞—Ç—ã–≤–∞—é—Ç (*rollback*)**¬†–∏–∑–º–µ–Ω–µ–Ω–∏—è.  
–†–∞–±–æ—Ç–∞–µ—Ç –≤¬†**–¥–≤–µ —Ñ–∞–∑—ã**:
1. **–§–∞–∑–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è (*Prepare Phase*)**    
    - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:¬†_¬´–ú–æ–∂–µ—Ç–µ –≤—ã–ø-—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é?¬ª_      
    - –£—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Ç–≤–µ—á–∞—é—Ç¬†**¬´–î–∞¬ª**¬†(*–≥–æ—Ç–æ–≤—ã*) –∏–ª–∏¬†**¬´–ù–µ—Ç¬ª**¬†(*–Ω–µ –≥–æ—Ç–æ–≤—ã*).    
2. **–§–∞–∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (*Commit/Rollback Phase*)**    
    - –ï—Å–ª–∏ –≤—Å–µ –≥–æ–ª–æ—Å–æ–≤–∞–ª–∏ ¬´–î–∞¬ª ‚Üí –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –∫–æ–º–∞–Ω–¥—É–µ—Ç¬†**¬´Commit¬ª**.        
    - –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω ¬´–ù–µ—Ç¬ª ‚Üí¬†**¬´Rollback¬ª**¬†–¥–ª—è –≤—Å–µ—Ö.        

---
## **üîπ –£—á–∞—Å—Ç–Ω–∏–∫–∏**
- **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä (*Coordinator*)**¬†‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–º 
	  (*–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∏–ª–∏ –°–£–ë–î*).    
- **–£—á–∞—Å—Ç–Ω–∏–∫–∏ (*Participants*)**¬†‚Äî —Å–µ—Ä–≤–∏—Å—ã –∏–ª–∏ –ë–î, –≤—ã–ø–æ–ª–Ω—è—é—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é.    

---
## **üîπ –ü–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã**

| **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**                            | **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**                                     |
| ------------------------------------------- | -------------------------------------------------- |
| **–ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å**¬†(*–≤—Å–µ –∏–ª–∏ –Ω–∏—á–µ–≥–æ*)          | **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏**¬†(*—Ä–µ—Å—É—Ä—Å—ã –∑–∞–º–æ—Ä–æ–∂–µ–Ω—ã –¥–æ –∫–æ–Ω—Ü–∞ 2PC*) |
| **–°—Ç—Ä–æ–≥–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**                 | **–ú–µ–¥–ª–µ–Ω–Ω—ã–π**¬†(*–∏–∑-–∑–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏*)              |
| –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è¬†**–∫—Ä–æ—Å—Å-—Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** | **–†–∏—Å–∫ –∑–∞–≤–∏—Å–∞–Ω–∏–π**¬†(*–µ—Å–ª–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —É–ø–∞–ª*)       |

---
## **üîπ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?**
- **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –ë–î**¬†(–Ω–∞–ø—Ä–∏–º–µ—Ä, PostgreSQL + MongoDB).    
- **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**¬†(–±–∞–Ω–∫–æ–≤—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è).    
- **–ö–æ–≥–¥–∞ Saga –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç**¬†(–Ω—É–∂–Ω–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å).    

---
## **üîπ –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è**
1. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (*Locking*)**    
    - –£—á–∞—Å—Ç–Ω–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç –¥–∞–Ω–Ω—ã–µ –¥–æ –∫–æ–Ω—Ü–∞ 2PC ‚Üí –≤–æ–∑–º–æ–∂–Ω—ã¬†**–¥–µ–¥–ª–æ–∫–∏**.        
    - **–†–µ—à–µ–Ω–∏–µ:**¬†–¢–∞–π–º–∞—É—Ç—ã –Ω–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ.        
2. **–û—Ç–∫–∞–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞**    
    - –ï—Å–ª–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —É–ø–∞–ª –ø–æ—Å–ª–µ ¬´Prepare¬ª, —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∑–∞–≤–∏—Å–∞—é—Ç.        
    - **–†–µ—à–µ–Ω–∏–µ:**        
        - **–¢–∞–π–º–∞—É—Ç—ã**¬†(–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç –ø—Ä–∏ –¥–æ–ª–≥–æ–º –æ–∂–∏–¥–∞–Ω–∏–∏).            
        - **–ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**¬†(–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—è).   
3. **–ù–∏–∑–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**    
    - **–†–µ—à–µ–Ω–∏–µ:**¬†–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.        

---
## **üîπ –û—Ç–ª–∏—á–∏–µ –æ—Ç Saga**

| **–ö—Ä–∏—Ç–µ—Ä–∏–π**           | **2PC**                        | **Saga**                      |
| ---------------------- | ------------------------------ | ----------------------------- |
| **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**    | –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è (*—Å—Ç—Ä–æ–≥–∞—è*)         | Eventual (*–≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å—á—ë—Ç–µ*) |
| **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏**         | –î–∞ (*—Ä–µ—Å—É—Ä—Å—ã –∑–∞–º–æ—Ä–æ–∂–µ–Ω—ã*)      | –ù–µ—Ç                           |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –ù–∏–∑–∫–∞—è                         | –í—ã—Å–æ–∫–∞—è                       |
| **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** | –°–ª–æ–∂–Ω–∞—è (*–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä ‚Äî SPOF*) | –ü—Ä–æ—Å—Ç–∞—è (*–¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ*)  |

---
## **üîπ –ì–¥–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è?**
- **–°–£–ë–î:**¬†XA-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (Oracle, PostgreSQL).    
- **–§—Ä–µ–π–º–≤–æ—Ä–∫–∏:**¬†Narayana, Atomikos (–¥–ª—è Java).    
- **–û–±–ª–∞–∫–∞:**¬†AWS Aurora, Google Spanner.    

---
#### **–ò—Ç–æ–≥:**  
2PC ‚Äî —ç—Ç–æ¬†**¬´–∂–µ—Å—Ç–∫–∏–µ¬ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**¬†—Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å—é.  
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ, –µ—Å–ª–∏:
- –ù—É–∂–Ω–∞¬†**—Å—Ç—Ä–æ–≥–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**.    
- –ú–æ–∂–Ω–æ —Ç–µ—Ä–ø–µ—Ç—å¬†**–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏**¬†–∏ –Ω–∏–∑–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å.    
#### **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- **Saga**¬†‚Äî –¥–ª—è –¥–æ–ª–≥–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.    
- **Saga + Outbox**¬†‚Äî –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –æ—á–µ—Ä–µ–¥—è–º–∏.

---

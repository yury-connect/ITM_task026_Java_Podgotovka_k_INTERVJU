# Принципы_взаимодействия_через_REST

Принципы REST (Representational State Transfer) — архитектурного стиля, который лежит в основе современного веба и большинства публичных API.

## Что такое `REST`? Простыми словами

Представьте, что вы приходите в библиотеку. Вы не меняете сами книги на полках, а обращаетесь к библиотекарю.

- **Вы (клиент)** — хотите получить информацию или выполнить действие.
    
- **Библиотекарь (сервер)** — хранит данные и знает, как с ними работать.
    
- **Каталог книг (ресурсы)** — это сами данные (например, список пользователей, заказов, товаров).
    
- **Ваш запрос (HTTP-запрос)** — вы говорите библиотекарю: "Дайте мне книгу №5" (GET), "Добавьте эту новую книгу" (POST), "Исправьте описание у книги №5" (PUT), "Удалите книгу №10" (DELETE).


REST — это набор правил, по которым вы и "библиотекарь" договариваетесь общаться, чтобы всегда понимать друг друга. Это не протокол, а **архитектурный стиль**.

---
## 6 ключевых принципов (ограничений) REST

Чтобы API считалось RESTful, оно должно следовать этим шести принципам.

#### 1. Единообразие интерфейса (Uniform Interface)

Это самый важный принцип. Он означает, что взаимодействие между клиентом и сервером должно быть стандартным и предсказуемым. Включает в себя:

- **Идентификация ресурсов** Каждый ресурс (пользователь, заказ, статья) должен быть уникально идентифицирован с помощью URI (URL). Например:
    
    - `GET /api/users/123` — получить пользователя с ID=123.
        
    - `GET /api/products` — получить список всех продуктов.
        
- **Манипуляция ресурсами через представления** Клиент работает с ресурсом не напрямую, а через его представление (например, в формате JSON или XML). Когда вы обновляете ресурс, вы отправляете серверу его новое представление, и сервер сам решает, как его применить.
    
    - Запрос: `PUT /api/users/123` с телом `{"name": "Анна", "email": "anna@mail.ru"}`
        
    - Сервер принимает это JSON-представление и обновляет данные пользователя.
        
- **Самодостаточые сообщения** Каждый запрос от клиента содержит всю необходимую информацию для его обработки. Серверу не нужно помнить предыдущие запросы (см. "Отсутствие состояния").
    
- **HATEOAS (Hypermedia as the Engine of Application State)** Это высший уровень зрелости REST API. Ответы сервера содержат не только данные, но и гиперссылки на возможные следующие действия.
    
    - Пример ответа:
```json
{
  "user": {
    "id": 123,
    "name": "Анна",
    "email": "anna@mail.ru"
  },
  "links": [
    { "rel": "self", "href": "/api/users/123" },
    { "rel": "friends", "href": "/api/users/123/friends" },
    { "rel": "orders", "href": "/api/orders?user_id=123" }
  ]
}
```
Клиент "переходит" по приложению, используя эти ссылки, как вы переходите по ссылкам на веб-странице.    

#### 2. Отсутствие состояния (Stateless)

Сервер **не хранит** никакой информации о состоянии клиента между запросами. Каждый запрос полностью самостоятелен.

- **Как это работает:** Если для доступа к данным нужна аутентификация, клиент должен отправлять токен или логин/пароль в **каждом** запросе. Сервер не помнит, что вы уже "вошли в систему" 2 запроса назад.
    
- **Преимущества:** Масштабируемость. Серверы можно легко добавлять, так как любой из них может обработать любой запрос, не беспокоясь о сессии пользователя.    

#### 3. Кэшируемость (Cacheable)

Ответы сервера должны явно указывать, можно ли их кэшировать и как долго. Это критически важно для производительности.

- Клиенты (или промежуточные прокси) могут сохранять ответы на повторяющиеся запросы, уменьшая нагрузку на сервер.
    
- Сервер использует HTTP-заголовки, такие как `Cache-Control`, чтобы управлять кэшированием.    

#### 4. Клиент-серверная архитектура (Client-Server)

Четкое разделение ответственности:

- **Клиент** отвечает за пользовательский интерфейс и взаимодействие с пользователем.
    
- **Сервер** отвечает за хранение данных, бизнес-логику и безопасность.
    

Это позволяет клиентам и серверам развиваться независимо друг от друга.

#### 5. Многоуровневая система (Layered System)

Архитектура может состоять из нескольких уровней (слоев). Клиент не знает, общается он напрямую с сервером или через промежуточные звенья (прокси, кэши, балансировщики нагрузки, шлюзы). Это повышает безопасность и масштабируемость.

#### 6. Код по требованию (Code on Demand, опциональный)

Сервер может временно расширять функциональность клиента, передавая ему исполняемый код (например, JavaScript-скрипты для браузера). Это единственный необязательный принцип.

---

### Как выглядит взаимодействие на практике? (HTTP-методы)

REST тесно связан с HTTP-методами (глаголами), которые определяют действие над ресурсом.

|HTTP-метод|Описание|Пример (CRUD)|Идемпотентность*|Безопасность*|
|---|---|---|---|---|
|**GET**|**Получить** ресурс или коллекцию.|`GET /api/users` (Read)|Да|Да|
|**POST**|**Создать** новый ресурс.|`POST /api/users` (Create)|Нет|Нет|
|**PUT**|**Обновить** (или создать) ресурс по известному URI.|`PUT /api/users/123` (Update)|Да|Нет|
|**PATCH**|**Частично обновить** ресурс.|`PATCH /api/users/123`|Нет|Нет|
|**DELETE**|**Удалить** ресурс.|`DELETE /api/users/123` (Delete)|Да|Нет|

_Примечания:_

- **Идемпотентность**: Повторение одного и того же запроса даст тот же результат. `GET /users/123` всегда вернет одни и те же данные. `PUT /users/123` с одними данными при повторении не изменит результат. `POST` не идемпотентен, так как каждый вызов создаст новый ресурс.
    
- **Безопасность**: Метод не меняет состояние ресурса на сервере. `GET` только читает, `POST`, `PUT`, `DELETE` — меняют.
    

### Пример запроса и ответа

**Запрос от клиента:**
```http
GET /api/users/456 HTTP/1.1
Host: example.com
Authorization: Bearer eyJhbGci...  # Токен для аутентификации (принцип Stateless)
User-Agent: MyApp/1.0
```

**Ответ от сервера:**
```http
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: max-age=3600  # Результат можно кэшировать на 1 час (принцип Cacheable)

{
  "id": 456,
  "name": "Иван Петров",
  "email": "ivan@example.com",
  "_links": {  # Пример HATEOAS (принцип Uniform Interface)
    "self": { "href": "/api/users/456" },
    "orders": { "href": "/api/orders?user_id=456" }
  }
}
```

### Итог: что такое RESTful API?

Это API, которое построено на ресурсах (сущностях), над которыми выполняются стандартные HTTP-действия (GET, POST, PUT, DELETE), и которое следует ключевым принципам REST, особенно **Единообразию интерфейса** и **Отсутствию состояния**.

---
